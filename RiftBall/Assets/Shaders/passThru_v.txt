
#version 330

layout(location = 4) in vec3 vIn_vertex;
layout(location = 5) in vec2 vIn_uv;
layout(location = 6) in vec3 vIn_normal;
layout(location = 7) in vec3 vIn_colour;


out VertexData
{
	vec3 normal;
	vec2 texCoord;
	vec4 colour;
	vec3 eyePos;
} vOut;
uniform mat4 u_mvp;
uniform mat4 u_mv;

uniform mat4 mvm; // modelview matrix
uniform mat4 prm; // projection matrix
//uniform mat4 cvm; // cameraview matrix
uniform mat4 localTransform;



void main()
{
	vOut.colour = vec4(vIn_colour, 1.0);
	vOut.texCoord = vIn_uv;

	vOut.eyePos = (u_mv * vec4(vIn_vertex, 1.0)).xyz;
	vOut.normal = (u_mv * vec4(vIn_normal, 0.0)).xyz;
	//gl_Position = (u_mvp * vec4(vIn_vertex, 1.0));

	//vOut.eyePos = mat3(mvm) * mat3(localTransform) * vIn_vertex;
	//vOut.normal = (mat3(mvm) * mat3(localTransform) * vIn_normal);
	vec4 localSpace = localTransform * vec4(vIn_vertex, 1.0);
	vec4 modelViewSpace = mvm * localSpace;
	vec4 worldSpace = prm * modelViewSpace;
	gl_Position = worldSpace;	//every vert shader must set gl_Position
}


